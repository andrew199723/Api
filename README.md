# Parts Search Aggregator

Простой сайт на FastAPI для управления поставщиками API и поиска деталей по артикулу сразу у всех включенных провайдеров.

## Быстрый старт

1. Установите зависимости:

```bash
python3 -m venv .venv
source .venv/bin/activate
pip install -r requirements.txt
```

2. Запустите сервер:

```bash
uvicorn app.main:app --reload --host 0.0.0.0 --port 8000
```

3. Откройте в браузере `http://localhost:8000`.

- Страница "Поставщики": добавление/редактирование провайдеров.
- Страница "Поиск": ввод артикула и выполнение аггрегированного поиска.

## Настройка провайдеров

- `URL шаблон`: используйте `{article}`, например: `https://api.example.com/search?q={article}`
- `Метод`: `GET` или `POST` (в UI используется только URL; для POST сейчас без тела запроса)
- `Заголовки (JSON)`: валидный JSON с парами ключ-значение
- `JMESPath выражение`: выражение для извлечения списка объектов из ответа

Пример JMESPath, если API возвращает `{"items": [...]}`:

```
items[*].{provider:'Example', article:sku, title:name, price:price, stock:stock, url:link}
```

Если выражение не указано, в результаты попадет весь ответ `data`.

## Заметки

- БД: SQLite файл `app.db` создается автоматически
- Таймаут запросов к провайдерам настраивается для каждого провайдера
- Асинхронные запросы к поставщикам выполняются параллельно